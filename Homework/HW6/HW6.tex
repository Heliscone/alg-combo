\documentclass[11pt]{article}
\usepackage[lightbagel]{evan}

\title{Algebraic Combinatorics: HW6}
\author{various.}
\date{\today}
\begin{document}
\maketitle
\begin{quest}[\textcolor{red}{Trees with prescribed degrees and Cayley's formula}]
    \begin{enumerate}[(a)]\phantom{0}

        \item Given positive integers $d_1,d_2,\dots,d_n$ such that $\sum d_i=2n-2$, show that the number of labelled trees on $[n]$ such that vertex $i$ has degree $d_i$ for each $i$ is \[\frac{(n-2)!}{\prod(d_i-1)!}.\]
        \item Prove Cayley's formula from (a).
        \item What is the number of all trees on $n$ vertices with exactly $n-l$ leaves? (Hint: You may use (a) and leave your answer in terms of \textit{Stirning's number of the second kind}.)
    \end{enumerate}
\end{quest}
\begin{proof}
    \begin{enumerate}[(a)]
        \item The proof via Prüfer codes is a trivial arrangement argument. Proceeding by induction on $n$, the base case $n=1$ is also trivial. So, assume that the statement holds for $n-1$, that is, there are \[\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\] ways to create a labelled tree with $\sum d_i=2n-4$.

        For $n$ vertices, notice that there must be at least one vertex with degree $1$ since the sum of degrees is $2n-2$. Assign $d_n$ to be the vertex with degree $1$. Then, we have $n-1$ remaining vertices ways to connect the $n$th vertex to. If we connect to the $k$th vertex, then we are interested in the number of labelled trees with degrees $d_1,d_2,\dots d_k-1,\dots,d_{n-1}$, which is $\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot (d_k-1)$. So, the total number of valid trees on $[n]$ vertices is
        \begin{align*}
            \sum_{k=1}^{n-1}\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot (d_k-1)&=\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot\sum_{k=1}^{n-1}(d_k-1)\\
            &=\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot(2n-3-(n-1))\\
            &=\frac{(n-2)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot\frac{1}{0!}\\
            &=\frac{(n-2)!}{\prod_{i=1}^n(d_i-1)!},
        \end{align*}
        as desired. The proof by induction is complete.
        \item Finding the total number of labelled trees on $[n]$ is the same to summing $\frac{(n-2)!}{\prod(d_i-1)!}$ over all possible degrees $d_1,d_2,\dots,d_n$ such that $\sum d_i=2n-2$. Note that $\frac{(n-2)!}{\prod(d_i-1)!}$ is the number of ways to order $n-2$ numbers in a row, where $x$ appears $d_x-1$ times, so our sum is counting the number of ways to list $n-2$ integers in an ordered row, where each number is between $1$ and $n$, which is precisely $n^{n-2}$.

        This proof effectively travels through Prüfer codes.
        \item Let vertices $l+1$ through $n$ be the leaves, so $d_{l+1}=d_{l+2}=\cdots=d_n=1$. The sum of the remaining degrees is $2n-2-(n-l)=n+l-2$. By (a), the number of trees is then \[\frac{(n-2)!}{\prod_{i=1}^l (d_i-1)!}\]
    \end{enumerate}
\end{proof}
\begin{quest}[\textcolor{red}{Counting Spanning trees of $K_{m,n}$}]
    Find the value of $\tau(K_{m,n})$ using:
    \begin{enumerate}[(i)]
        \item Matrix-Tree Theorem.
        \item Combinatorial argument, say, that of Prüfer or Joyal.
        \item Let $L$ be the Laplacian of $K_{m,n}$.
            \begin{enumerate}[(a)]
                \item Find a simple upper bound on $\mathop{\mathrm{rank}}(L-mI)$.
            \end{enumerate}
    \end{enumerate}
\end{quest}
\begin{proof}
    \begin{enumerate}
        \item Recall that the Matrix-Tree Theorem states that $\tau(G) = |L_0|$. We let vertices $v_1$ through $v_m$ be within the first partite and $v_{m+1}$ through $v_{m+n}$ be within the second partite. Then, the Laplacian of $K_{m,n}$ is \[L=\begin{pmatrix}mI_n&-J\\-J&nI_m\end{pmatrix},\] where $J$ is the all-ones matrix. Then, we have \[L_0=\begin{pmatrix}mI&-J\\-J&nI\end{pmatrix}_{\{v_1,v_2,\dots,v_{m+n-1}\}}=\begin{pmatrix}mI&-J\\-J&nI\end{pmatrix}_{\{v_1,v_2,\dots,v_m\}}.\] The determinant of this matrix is \[mI\cdot nI-J^2=mIn-nJ^2=mIn-nJn=n(m-n),\] so $\tau(K_{m,n})=n(m-n)$.
    \end{enumerate}
\end{proof}
\setcounter{problem}{3}
\begin{quest}
    Starting at a point $x_0$ we walk along the edges of a connected graph $G$ according to the following rules:
    \begin{itemize}
        \item We never use the same edge twice in the same direction.
        \item Whenever we arrive at a point $x\neq x_0$ not previously visited, we mark the edge along which we entered $x$. We use the marked edge to leave $x$ only if we must, that is, if we have used all the other edges before.
    \end{itemize}
    Show that we get stuck at $x_0$, and that, by then, every edge has been traversed in both direction.
\end{quest}
\begin{proof}
    Set the vertex at which we get stuck to be $v$. Suppose, for the sake of contradiction, then $v\neq x_0$. Then, if we consider the number of times we have traversed an edge to arrive \textit{at} $v$, this must be one more than the number of times we have traversed an edge to leave \textit{from} $v$. Thus, there must be at least one edge that we have not traversed in both directions, so we may traverse that edge and leave. Therefore, we must be stuck at $x_0$.

    We now show that, when we get stuck at $x_0$, every other edge must be traversed in both directions, where we duplicate each edge and direct it, to create the enter-exit effect. Then, consider the ``in-tree'' rooted at $x_0$. Suppose, for the sake of contradiction, that we get stuck at $x_0$ when there is still some untraversed edges. At least one of those eddges but be an edge of the in-tree rooted at $v$, and let the point closest to $x_0$ (in the in-tree) on an untraversed edge of the in-tree be $y$. Since we travel to and from $y$ an equal number of times, there is an ``exit'' from $y$ we don't use, so $y$ is closer to $x_0$ than the initial vertex on the untraversed edge, meaning that $y=v$ (by the choice of edge). But, if there is an in-edge to $x_0$, then we must certainly also have an unused out-edge, contradicting our stuckness. So, all edges are traversed in our manually constructed directed graph, meaning all edges are traversed twice in the original graph.
\end{proof}
\begin{quest}[\textcolor{red}{Universal cycles for $S_n$}]
    \begin{enumerate}[(i)]
        \item Let $n\geq 3$. Show that there does not exist a sequence $a_1,a_2,\dots,a_{n!}$ such that all the $n!$ contiguous blocks $a_{i},a_{i+1},\dots,a_{i+n-1}$ (subscripts taken modulo $n!$) are all the $n!$ permutations of $S_n$.
        \item Show that for all $n\geq 1$, there exist a sequence $a_1,a_2,\dots,a_{n!}$ such that all the $n!$ contiguous blocks $a_{i},a_{i+1},\dots,a_{i+n-1}$ consists of the first $n-1$ terms $b_1,b_2,\dots,b_{n-1}$ of all permutations $b_1,b_2,\dots,b_n$ of $[n]$. 
        
        Such sequences are called \vocab{universal cycles} for $S_n$ (for example, for $n=3$, $123213$ is a universal cycle.)
        \item For $n=3$, find the number of universal cycles beginning with $123$.
    \end{enumerate}
\end{quest}
\end{document}
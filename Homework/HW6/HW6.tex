\documentclass[11pt]{article}
\usepackage[lightbagel]{evan}

\title{Algebraic Combinatorics: HW6}
\author{various.}
\date{\today}
\begin{document}
\maketitle
\begin{quest}[\textcolor{red}{Trees with prescribed degrees and Cayley's formula}]
    \begin{enumerate}[(a)]\phantom{0}

        \item Given positive integers $d_1,d_2,\dots,d_n$ such that $\sum d_i=2n-2$, show that the number of labelled trees on $[n]$ such that vertex $i$ has degree $d_i$ for each $i$ is \[\frac{(n-2)!}{\prod(d_i-1)!}.\]
        \item Prove Cayley's formula from (a).
        \item What is the number of all trees on $n$ vertices with exactly $n-l$ leaves? (Hint: You may use (a) and leave your answer in terms of \textit{Stirning's number of the second kind}.)
    \end{enumerate}
\end{quest}
\begin{proof}
    \begin{enumerate}[(a)]
        \item The proof via Prüfer codes is a trivial arrangement argument. Proceeding by induction on $n$, the base case $n=1$ is also trivial. So, assume that the statement holds for $n-1$, that is, there are \[\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\] ways to create a labelled tree with $\sum d_i=2n-4$.

        For $n$ vertices, notice that there must be at least one vertex with degree $1$ since the sum of degrees is $2n-2$. Assign $d_n$ to be the vertex with degree $1$. Then, we have $n-1$ remaining vertices ways to connect the $n$th vertex to. If we connect to the $k$th vertex, then we are interested in the number of labelled trees with degrees $d_1,d_2,\dots d_k-1,\dots,d_{n-1}$, which is $\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot (d_k-1)$. So, the total number of valid trees on $[n]$ vertices is
        \begin{align*}
            \sum_{k=1}^{n-1}\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot (d_k-1)&=\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot\sum_{k=1}^{n-1}(d_k-1)\\
            &=\frac{(n-3)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot(2n-3-(n-1))\\
            &=\frac{(n-2)!}{\prod_{i=1}^{n-1}(d_i-1)!}\cdot\frac{1}{0!}\\
            &=\frac{(n-2)!}{\prod_{i=1}^n(d_i-1)!},
        \end{align*}
        as desired. The proof by induction is complete.
        \item Finding the total number of labelled trees on $[n]$ is the same to summing $\frac{(n-2)!}{\prod(d_i-1)!}$ over all possible degrees $d_1,d_2,\dots,d_n$ such that $\sum d_i=2n-2$. Note that $\frac{(n-2)!}{\prod(d_i-1)!}$ is the number of ways to order $n-2$ numbers in a row, where $x$ appears $d_x-1$ times, so our sum is counting the number of ways to list $n-2$ integers in an ordered row, where each number is between $1$ and $n$, which is precisely $n^{n-2}$.

        This proof effectively travels through Prüfer codes.
        \item Let vertices $l+1$ through $n$ be the leaves, so $d_{l+1}=d_{l+2}=\cdots=d_n=1$. The sum of the remaining degrees is $2n-2-(n-l)=n+l-2$. By (a), the number of trees is then \[\frac{(n-2)!}{\prod_{i=1}^l (d_i-1)!}\]
    \end{enumerate}
\end{proof}
\begin{quest}[\textcolor{red}{Counting Spanning trees of $K_{m,n}$}]
    Find the value of $\tau(K_{m,n})$ using:
    \begin{enumerate}[(i)]
        \item Matrix-Tree Theorem.
        \item Combinatorial argument, say, that of Prüfer or Joyal.
        \item Let $L$ be the Laplacian of $K_{m,n}$.
            \begin{enumerate}[(a)]
                \item Find a simple upper bound on $\mathop{\mathrm{rank}}(L-mI)$.
                \item Deduce a lwoer bound on the multiplicity of eigenvalue $L$ equal to $m$.
                \item Assume $m\neq n$ and do the same for $n$.
                \item Find the remaining eigenvalues of $L$.
                \item Use (a)-(d) to compute $\tau(K_{m,n})$.
            \end{enumerate}
    \end{enumerate}
\end{quest}
\begin{proof}
    \begin{enumerate}[(i)]
        \item Recall that the Matrix-Tree Theorem states that $\tau(G) = |L_0|$. We let vertices $v_1$ through $v_m$ be within the first partite and $v_{m+1}$ through $v_{m+n}$ be within the second partite. Then, the Laplacian of $K_{m,n}$ is \[L=\begin{pmatrix}nI_m&-J_{m \times n}\\-J_{n \times m}&mI_n\end{pmatrix},\] Then, we have
        \[
            L_0=\begin{pmatrix}nI_m&-J_{m \times (n-1)}\\-J_{(n-1) \times m}&mI_{n-1}\end{pmatrix}.
        \]

        Now all we must do is evaluate $|L_0|$. Adding all of the rows to the first row, we get
        \[
            |L_0| = \begin{pmatrix}
                1 & \cdots & \cdots & 1 & 0 & \cdots & 0\\
                0 & n & 0 & 0 & 
            \end{pmatrix}
        \]

        \item First, we note that one of the partites of $K_{m,n}$ must be larger than the other. [EXPLANATION OF THIS] Therefore, WLOG, let $n > m$. We divide the vertices of $K_{m,n}$ into two sets, $A$ and $B$, where $|A|=m$ and $|B|=n$. Then, we delete the smallest leaf in B and append its neighbor to the Prüfer code. We repeat this process until $|B|=m$. Then, we delete the smallest leaf in $A$ and append its neighbor to the Prüfer code, followed by deleting the smallest leaf in $B$ and appending its neighbor, etc.
        
        From the first part of the process, we have $n^{m-n}$ ways to choose the neighbors of the leaves in $B$, and from the second part of the process, we have $m^{m-1} n^{m-1}$ ways to choose the neighbors of the leaves in $A$. Whence,
        \[
            \tau(K_{m,n})={m-n}m^{m-1} n^{m-1}=n^{m-1}m^{n-1}
        \].
    \end{enumerate}
\end{proof}
\setcounter{problem}{3}
\begin{quest}
    Starting at a point $x_0$ we walk along the edges of a connected graph $G$ according to the following rules:
    \begin{itemize}
        \item We never use the same edge twice in the same direction.
        \item Whenever we arrive at a point $x\neq x_0$ not previously visited, we mark the edge along which we entered $x$. We use the marked edge to leave $x$ only if we must, that is, if we have used all the other edges before.
    \end{itemize}
    Show that we get stuck at $x_0$, and that, by then, every edge has been traversed in both direction.
\end{quest}
\begin{proof}
    Set the vertex at which we get stuck to be $v$. Suppose, for the sake of contradiction, then $v\neq x_0$. Then, if we consider the number of times we have traversed an edge to arrive \textit{at} $v$, this must be one more than the number of times we have traversed an edge to leave \textit{from} $v$. Thus, there must be at least one edge that we have not traversed in both directions, so we may traverse that edge and leave. Therefore, we must be stuck at $x_0$.

    We now show that, when we get stuck at $x_0$, every other edge must be traversed in both directions, where we duplicate each edge and direct it, to create the enter-exit effect. Then, consider the ``in-tree'' rooted at $x_0$. Suppose, for the sake of contradiction, that we get stuck at $x_0$ when there is still some untraversed edges. At least one of those eddges but be an edge of the in-tree rooted at $v$, and let the point closest to $x_0$ (in the in-tree) on an untraversed edge of the in-tree be $y$. Since we travel to and from $y$ an equal number of times, there is an ``exit'' from $y$ we don't use, so $y$ is closer to $x_0$ than the initial vertex on the untraversed edge, meaning that $y=v$ (by the choice of edge). But, if there is an in-edge to $x_0$, then we must certainly also have an unused out-edge, contradicting our stuckness. So, all edges are traversed in our manually constructed directed graph, meaning all edges are traversed twice in the original graph.
\end{proof}
\begin{quest}[\textcolor{red}{Universal cycles for $S_n$}]
    \begin{enumerate}[(i)]
        \item Let $n\geq 3$. Show that there does not exist a sequence $a_1,a_2,\dots,a_{n!}$ such that all the $n!$ contiguous blocks $a_{i},a_{i+1},\dots,a_{i+n-1}$ (subscripts taken modulo $n!$) are all the $n!$ permutations of $S_n$.
        \item Show that for all $n\geq 1$, there exist a sequence $a_1,a_2,\dots,a_{n!}$ such that all the $n!$ contiguous blocks $a_{i},a_{i+1},\dots,a_{i+n-2}$ consists of the first $n-1$ terms $b_1,b_2,\dots,b_{n-1}$ of all permutations $b_1,b_2,\dots,b_n$ of $[n]$. 
        
        Such sequences are called \vocab{universal cycles} for $S_n$ (for example, for $n=3$, $123213$ is a universal cycle.)
        \item For $n=3$, find the number of universal cycles beginning with $123$.
    \end{enumerate}
\end{quest}
\begin{proof}
    \begin{enumerate}[(i)]
        \item There are $(n-1)!$ sequences that begin with a given $i$ (integer $1\leq i\leq n$), so the $i$s must be evenly spaced throughout the sequence, which means that the sequence is just $(n-1)!$ copis of $a_1,a_2,\dots,a_n$, which will certainly not contain all $n!$ permutations of $S_n$.
        
        For the example of $n=3$, the requirement of $2$ blocks beginning wth $1,2,$ and $3$ force a structure of $ABCABC$, which, because of the repeat, doesn't contain all $n!$ permutations. 
        \item %I DONT KNOWWWWWWWWWW
        \item The beginning $123$ gives blocks of $12$ and $23$, so the next term can be a block of $32$ or $31$, giving cases of:
        \begin{enumerate}
            \item $1232$: we've accounted for $23$ already, so the next number must be $1$. In $12321$, we already have a $12$, so the next number must be $3$, yielding the universal cycle $123213$.
            \item $1231$: we've accounted for $12$ already, so the next number must be $3$. In $12313$, we already have a $31$, so the last number must be a $2$, yielding the universal cycle $123132$.
        \end{enumerate}
        We confirm that all permutations are present, so the two universal cycles are \[\boxed{12313,123132}.\]
    \end{enumerate}
\end{proof}
\end{document}
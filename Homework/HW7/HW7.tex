\documentclass[letterpaper]{article}
\usepackage[lightbagel]{evan}

\title{Algebraic Combinatorics - HW7}
\author{Sawyer, Evan, Dallin, Alexander.}
\date{04/09/2024}
\begin{document}
\maketitle
\begin{quest}[\textcolor{red}{Lattice Paths avoiding a certain set of points}]
Let $P$ be a fixed lattice (ballot) path from $(0,0)$ to $(m,n)$. Let $T$ be a set of interior points on $P$ (that is, some subset of points on $P$ other than $(0,0)$ and $(m,n)$). Let $f_{m,n}(T)$ be the number of lattice paths from $(0,0)$ to $(m,n)$ that avoid all of $T$.
\begin{enumerate}[(i)]
    \item Use a Corollary of Gessel-Viennot Lemma to find an expression for $f_{m,n}(T)$.
    \item Use Inclusion-Exclusion to find an expression for $f_{m,n}(T)$.
\end{enumerate}
\end{quest} 
\begin{proof}
\begin{enumerate}[(i)]
%We begin with the formula for the total number of lattice paths from $(0,0)$ to $(m,n)$: ${ m+n \choose m}$. First, consider the case where $T$ has only one point with coordinates $(a_1, b_1)$. The number of lattice paths from $(0,0)$ to $(a_1, b_1)$ is ${a_1+b_1 \choose a_1}$, and the number of lattice paths from $(a_1, b_1)$ to $(m,n)$ is ${(m-a_1)+(n-b_1) \choose m-a_1}$. Multiplying these two together, we get ${a_1+b_1 \choose a_1}*{(m-a_1)+(n-b_1) \choose m-a_1}$ as the number of lattice paths that are not available. Suppose $T$ has a second point with coordinates $(a_2, b_2)$. We need to avoid all paths that pass through either $(a_1, b_1)$ or $(a_2, b_2)$, but we cannot double-count the paths that go through both points, so our expression for the number of paths that are not available is ${a_1+b_1 \choose a_1}*{(m-a_1)+(n-b_1) \choose m-a_1}+{a_2+b_2 \choose a_2}*{(m-a_2)+(n-b_2) \choose m-a_2}-$
    \item Let $A$ be an ordered list of points $P_i=(a_i,b_i)$ on $T$, with last element $(0,0)$. Let $B$ be an ordered list of the same $P_i$, except with last element $(m,n)$ instead of $(0,0)$. Construct the directed acyclic graph $G$, the grid of points from $(0,0)$ to $(m,n)$, with edges going up or right with weight $1$. Our path matrix $M$ is a $|A|\times |B|$ matrix, that is, an $(|T|+1)\times (|T|+1)$ matrix. The number of paths from $P_i$ to $P_j$ is naturally $\binom{a_j-a_i+b_j-b_i}{a_j-a_i}$ (note this is zero when $P_i$ is after $P_j$). Thus, Gessel-Viennot Lemma gives us that the sum of signed vertex-disjoint paths from $A$ to $B$ is $\det M$. However, since the permutations are signed, the only path system that survives is that the identity, which counts the number of paths from $(0,0)$ to $(m,n)$ avoiding $T$. Therefore, \[f_{(m,n)}(T)=\det(\left[\binom{a_j-a_i+b_j-b_i}{a_j-a_i}\right])\]
    \item We use PIE to count the number of ballot paths that intersect at least one vertex in $T$. Let $t_1,t_2,\dots,t_k$ be the vertices of $T$, where $t_i=(x_i,y_i)$. Let $B$ be the set of all ``bad'' ballot paths from $(0,0)$ to $(m,n)$, and consider the subsets $B_i\subset B$ where $B_i$ is the set of all ballot paths that intersect $t_i$. Then, by PIE, \[|B|=\sum_{1\leq i\leq k}|B_i|-\sum_{1\leq i<j\leq k}|B_i\cap B_j|+\cdots,\] that is, \[\sum_{i=1}^k\paren{(-1)^{i+1}\sum_{1\leq c_1<\cdots<c_i\leq k}|B_{c_1}\cap B_{c_2}\cap\cdots\cap B_{c_i}|}\]
    Notice that $|B_{c_1}\cap \dots \cap B_{c_i}|$ is the number of ballot paths through $t_{c_1},\dots,t_{c_i}$, which is \[\prod_{v=0}^i\dbinom{x_{c_{v+1}}-x_{c_v}+y_{c_{v+1}}-y_{c_v}}{x_{c_{v+1}}-x_{c_v}},\] where $x_{c_0}=y_{c_0}=0$ and $x_{c_{i+1}}=m$, $y_{c_{i+1}}=n$, whence 
    \[|B|=\sum_{i=1}^k\paren{(-1)^{i+1}\sum_{1\leq c_1<\cdots<c_i\leq k}\prod_{v=0}^i\dbinom{x_{c_{v+1}}-x_{c_v}+y_{c_{v+1}}-y_{c_v}}{x_{c_{v+1}}-x_{c_v}}}.\]
    \end{enumerate}
\end{proof}
\begin{quest}[\textcolor{red}{Linear dependency and Gessel-Vienot}]
    Let $A_{n\times n}$ be a matrix with linearly dependent rows. Show by using Gessel-Viennot Lemma that $|A|=0$.
\end{quest}
\begin{proof}
    Let $A_{n\times n}$ represent the edge matrix of a weighted DAG from $A=\{a_1,a_2,\dots,a_n\}$ and $B=\{b_1,b_2,\dots,b_n\}$. Let $e_{ij}=[A_{ij}]$. Then, since the rows are linearly independent, the first row can be written as a linear combination of the other rows, say \[e_{1j}=\sum_{2\leq i\leq n}c_ie_{ij}.\]
    We can construct our graph with $a_1$ above all the other $a_i$, with the example for $n=4$ shown below:
    \begin{center}
        \begin{asy}
            dot((0,1));
            label("$a_1$",(0,1),N);
            label("$a_2$",(-1,0),W);
            label("$a_3$",(0,0),ENE);
            label("$a_4$",(1,0),E);
            for(int i=-1;i<=1;++i) {
                dot((i,0));
                draw((0,1)--(i,0),Arrow);
                for(int j=0; j<=3; ++j) {
                    draw((i,0)--(j-1.5,-1),Arrow);
                    if(i==-1) {
                        dot((j-1.5,-1));                    
                    }
                }
            }
            label("$b_1$",(-1.5,-1),S);
            label("$b_2$",(-0.5,-1),S);
            label("$b_3$",(0.5,-1),S);
            label("$b_4$",(1.5,-1),S);
        \end{asy}
    \end{center}
    We can set the edge from $a_1$ to $a_k$ to have weight $c_k$, whence we have the linear combination relationship in $A$. For example, \[e_{11}=e_{21}c_2+e_{31}c_3+e_{41}c_4.\] By the Gessel-Viennot Lemma, the determinant of $A$ is the sum of the weights of all path systems from $A$ to $B$. However, notice that the path system from $a_1$ to $b_{\sigma(a_1)}$ will have an odd number of vertices, while the path system from all other $a_i$ to $b_{\sigma(a_i)}$ will have an even number of vertices, while $|A|+|B|=2n$ is even. Therefore, there are no path systems, so \[\det A=\sum_{\mathscr{P}}\text{sign}(\mathscr{P})\omega(\mathscr{P})=0.\]
\end{proof}
\begin{quest}[\textcolor{red}{GCD matrix}]
    Let $S=\{a_1,a_2,\dots,a_n\}\subset\NN$. let the \vocab{GCD matrix} $M$ of $S$ have entries $m_{ij}=\gcd(a_i,a_j)$. Prove that if $S$ is closed under taking divisors, then \[|M|=\prod_{i=1}^n\varphi(a_i).\]
    (\textit{Hint:} Form a certain digraph using three copies of $S$, and then put certain edges and weights on them.)
\end{quest}
\begin{proof}
    We form a digraph between $S$, $T$, and $U$, where $T$ and $U$ are two copies of $S$, placing edges in a way that allows us to make use of the Totient Function's divisor sum. For a given $1\leq i\leq n$, let $d$ be a divisor of $i$. Then, we place an edge from $s_i$ to $t_d$ of weight $\phi(d)$ and an edge from $t_d$ to $u_i$ of weight $1$. We give the examples of $n=4$ and $n=6$, where the colorings  are relevant for our path counting argument:
    \begin{center}
        \begin{asy}
            for(int i=1;i<=4;++i) {
                dot((i,0));
                dot((i,-1));
                dot((i,-2));
                label("$s_"+string(i)+"$",(i,0),N);
                label("$t_"+string(i)+"$",(i,-1),W);
                label("$u_"+string(i)+"$",(i,-2),S);
                for(int j=1;j<=i;++j) {
                    if(i%j==0) {
                        pen p=hsv(i*90,1,0.8);
                        draw((i,0)--(j,-1),p,Arrow);
                        if(j==1) {
                            label("$\phi("+string(j)+")$",(0.7*(i,0)+0.3*(j,-1)),N,p);
                        }
                        else {
                            label("$\phi("+string(j)+")$",(0.3*(i,0)+0.7*(j,-1)),p);
                        }
                        draw((j,-1)--(i,-2),p,Arrow);
                    }
                }
            }
        \end{asy}

        \begin{asy}
            for(int i=1;i<=6;++i) {
                dot((i,0));
                dot((i,-1));
                dot((i,-2));
                for(int j=1;j<=i;++j) {
                    if(i%j==0) {
                        pen p=hsv(i*60,1,0.8);
                        draw((i,0)--(j,-1),p,Arrow);
                        draw((j,-1)--(i,-2),p,Arrow);
                    }
                }
            }
            pen p=hsv(0,1,1);
        \end{asy}
    \end{center}
    \textcolor{black}
    Consider the edge matrix $A$ of this graph, where $a_{ij}$ is the number of paths from $s_i$ to $u_j$. By our setup, \[a_{ij}=\sum_{d|i,j}\phi(d)=\sum_{d|(i,j)}\phi(d)=(i,j),\] so $A=M$. By the Gessel-Viennot Lemma, $|M|=|A|$, which is the sum of the weights of all path systems from $S$ to $U$. Notice that $\sigma(s_1)$ is necessarily $u_1$, whence $\sigma(s_p)=u_p$ for all prime $p$. We can continue inductively on the number of divisors to conclude that $\sigma(s_k)=u_k$ for all $1\leq k\leq n$, so we only have one path system $\mathscr{P}$, and $\omega(\mathscr{P})=\prod_{i=1}^n\varphi(i)$, as desired.
\end{proof}
\begin{quest}[\textcolor{red}{Determinant of a matrix of Stirling Numbers}]
    For $m\geq0$, $n\geq 1$, prove the following identity. Here $S_{n,k}$ is the Stirling number of the $2^{\text{nd}}$ kind.
    \[\det\begin{pmatrix}S_{m+1,1}&S_{m+1,2}&\cdots&S_{m+1,n}\\S_{m+2,1}&S_{m+2,2}&\cdots&S_{m+2,n}\\\vdots&\vdots&\ddots&\vdots\\S_{m+n,1}&S_{m+n,2}&\cdots&S_{m+n,n}\end{pmatrix}=(n!)^m\]
\end{quest}
\begin{proof}
    Construct a digraph as shown in the hint, with vertices $x_n$ through $x_1$, followed by $m+1$ vertices on the horizontal axis and $y_1$ through $y_n$ on the vertical axis.

    With a digraph as shown below, we use the Gessel-Viennot lemma on the path systems from the $x_i$ to $y_i$.

    We construct the path matrix by considering the weighted sum of path systems from the $x_i$ to the $y_i$. From the weighting, the only surviving path is the identity. the number of ways to get from $x_i$ to $y_i$ is $n!$: we must start by taking $i$ up-right steps, since the paths must be vertex disjoint. We then take $m$ steps to the right, each of which has width $i$. Thus, the weight of the surviving path system is $(n!)^m$.

    The number of paths from $x_i$ to $y_j$ is $S_{m+i,j}$ as well: a path from $x_i$ to $y_j$ involves taking $j$ steps up-right and $m+i-j$ steps right. We are effectively splitting the $m+i$ steps to the right across the $j$ levels, where a setp up from the $y_k$ to $y_{k+1}$ level counts as a step to the right for the $k$th level. Thus, we are splitting $m+i$ steps into $j$ partitions, that is, $S_{m+i,j}$.

    Thus, Gessel-Viennot gives the desired result.
\end{proof}
\end{document}

\documentclass[11pt]{scrartcl}
\usepackage{evan}
\usepackage{asymptote}

\title{Algebraic Combinatorics HW 1}
\author{Evan Lim and Dallin Guisti}
\date{2-6-2024}
\definecolor{palegreen}{rgb}{0.6, 0.98, 0.6}
\begin{document}
\maketitle
\setcounter{section}{1}
\begin{problem}[\textcolor{red}{Closed Walks in $K_n$}]
    Find a combinatorial proof of the fact that $\#$ closed walks of length $l$ in $K_n$ from some vertex to itself is \[\frac{1}{n}\left((n-1)^l+(n-1)(-1)^l\right)\]
\end{problem}
\begin{proof}
    We'll count the number of closed $l$-walks from $v_1$ to $v_1$, which, by symmetry, is the number of closed $l$-walks from any vertex to itself. We write each walk as an ordered list of vertices, so that we must find the number of walks 
    \[v_1,v_{i_1},v_{i_2},\cdots,v_{i_{l-1}},v_1\] with adjacent vertices distinct, so $v_{i_k}\neq v_{i_{k+1}}$ and $v_{i_1},v_{i_{l-1}}\neq v_1$. 
    
    We start our count with the number of valid walks when neglecting the $v_{i_{l-1}}\neq v_1$ constraint: there are $(n-1)^{l-1}$ such walks ($l-1$-walks beginning at $v_1$). 
    
    We then must subtract the number of sequences where $v_{i_{l-1}}=v_1$, (the number of closed $l-1$-walks)
    \footnote{This suggests that we could complete via an inductive proof, using \[(n-1)^{l}-\frac{1}{n}\left((n-1)^{l-1}+(n-1)(-1)^{l-1}\right)=\frac{1}{n}\left((n-1)^{l}+(n-1)(-1)^l\right).\]}. 
    Repeating the same reasoning, we find the number of closed $l-1$-walks by taking $(n-1)^{l-2}$ and then subtracting the number of closed $l-2$-walks. In this way, and finishing with $n-1$ $2$-walks, the number of closed $l$-walks from a vertex to itself is
    \begin{align*}
        &(n-1)^{l-1}-(n-1)^{l-2}+(n-1)^{l-3}+\cdots+(-1)^l(n-1)\\
        &=\sum_{k=1}^{l-1}(n-1)^k(-1)^{l-1+k}\\
        &=(-1)^{l-1}\sum_{k=1}^{l-1}(1-n)^k\\
        &=(-1)^{l-1}\frac{(1-n)\left((1-n)^{l-1}-1\right)}{1-n-1}\\
        &=(-1)^{l}\frac{(1-n)^{l}-(1-n)}{n}\\
        &=\frac{1}{n}\left((n-1)^l+(n-1)(-1)^l\right),
    \end{align*}
    as desired.
\end{proof}
\begin{problem}[\textcolor{red}{Eigenvalues of some bipartite graphs}]
    \phantom{0}
    \begin{enumerate}[(i)]
        \item Let $G[A,B]$ be a bipartite graph with partite sets $A,B$. Show by a walk-counting argument that the non-zero eigenvalues of $G$ come in pairs $\pm \lambda$.\\
        (\textcolor{red}{Eigenvalues of $K_{rs}$}) Consider the complete bipartite graph $K_{r,s}$ (that is, having partite sets of size $r$ and $s$)
        \item Use purely combinatorial reasoning to compute the number of closed walks of length $l$ in $K_{r,s}$.
        \item Deduce the eigenvalues of $K_{r,s}$.\\
        (\textcolor{red}{Eigenvalues of $K_{n,n}-nK_2$}) Let $H_n$ be the graph $K_{n,n}$ with a perfect matching removed.
        \item Show that the eigenvalues of $H_n$ are \[\pm 1(n-1\text{ times}),\pm(n-1)\text{(once each)}.\]
    \end{enumerate}
\end{problem}
\begin{proof}
    \phantom{0}
    \begin{center}
        \begin{asy}
            size(3cm);
            draw(ellipse((-5,0),2,5));
            draw(ellipse((5,0),2,5));
            label("$A$",(-5,-7));
            label("$B$",(5,-7));
            pair A1,A2,A3,B1,B2,B3;
            A1 = (-5,3);
            A2 = (-5,0);
            A3 = (-5,-3);
            B1 = (5,3);
            B2 = (5,0);
            B3 = (5,-3);
            draw(A1--B2);
            draw(A2--B1);
            draw(A3--B3);
            dot(A1); dot(A2); dot(A3); dot(B1); dot(B2); dot(B3);
        \end{asy}
    \end{center}
    \begin{enumerate}[(i)]
        \item Every step on a walk takes us between partite sets $A$ and $B$. Thus, there are no $2l+1$-walks, meaning that \[\sum (\lambda_i)^{2l+1}=0,\] so \[\sum(-\lambda_i)^{2l+1}=-\sum(\lambda_i)^{2l+1}=0=\sum (\lambda_i)^{2l+1}.\] As $\sum(\lambda_i)^{2l}=\sum(-\lambda_i)^{2l}$, $\sum\lambda_i^k$ and $\sum(-\lambda_i)^k$ agree for all positive integers $k$, so the $-\lambda_i$ are simply a permutation of the $\lambda_i$, meaning that all nonzero eigenvalues come in $\pm\lambda$ pairs.
        \begin{center}
            \begin{asy}
                size(3cm);
                draw(ellipse((-5,0),2,5));
                draw(ellipse((5,0),2,5));
                label("$r\phantom{0}(A)$",(-5,-7));
                label("$s\phantom{0}(B)$",(5,-7));
                pair A1,A2,A3,B1,B2,B3;
                A1 = (-5,3);
                A2 = (-5,0);
                A3 = (-5,-3);
                B1 = (5,3);
                B2 = (5,3);
                B3 = (5,-3);
                draw(A1--B1);draw(A1--B2);draw(A1--B3);
                draw(A2--B1);draw(A2--B2);draw(A2--B3);
                draw(A3--B3);draw(A3--B2);draw(A3--B3);
                dot(A1); dot(A2); dot(A3); dot(B1); dot(B2); dot(B3);
            \end{asy}
        \end{center}
        \item Call the partite with $r$ elements $A$ and the partite with $s$ elements $B$. If $l$ is odd, there are zero walks. So, we assume $l$ is even. If we begin our $l$-walk in $A$, we know go from $A$ to $B$ $l$ times and $B$ to $A$ $l$ times. Each time we go from $A$ to $B$, we have $s$ options. Each time we go from $B$ to $A$, we have $r$ options, except the last step, at which point we must return to our original vertex, for which we have $r$ choices. There are thus $s^{l}r^{l-1}r=(rs)^l$ $l$-walks beginning in $A$, and an identical argument gives $(rs)^l$ $l$-walks beginning in $B$. There are thus \[\begin{cases}0&l\text{ odd}\\2(rs)^l&l\text{ even}\end{cases}\] $l$-walks.
        \item $\sum\lambda_i^l$ and $(rs)^l+(-rs)^l+(n-2)\cdot(0)^l$ agree for all positive $l$, so the eigenvalues of $K_{r,s}$ are \[\pm rs,0\text{ }(r+s-2\text{ times}).\]
        We now consider the $K_{n,n}-nK_2$ graph, providing $n=3$ as an example:
        \begin{center}
            \begin{asy}
                size(3cm);
                draw(ellipse((-5,0),2,5));
                draw(ellipse((5,0),2,5));
                label("$A$",(-5,-7));
                label("$B$",(5,-7));
                pair A1,A2,A3,B1,B2,B3;
                A1 = (-5,3);
                A2 = (-5,0);
                A3 = (-5,-3);
                B1 = (5,3);
                B2 = (5,0);
                B3 = (5,-3);
                draw(A1--B1,dashed+red);draw(A1--B2);draw(A1--B3);
                draw(A2--B1);draw(A2--B2,dashed+red);draw(A2--B3);
                draw(A3--B1);draw(A3--B3,dashed+red);draw(A3--B2);
                dot(A1); dot(A2); dot(A3); dot(B1); dot(B2); dot(B3);
            \end{asy}
        \end{center}
        \item We aim to find the number of $l$-walks (for even $l$) on $K_{n,n}-nK_2$. If we write the partites as $a_1,a_2,\cdots, a_n$ and $b_1,b_2,\cdots,b_n$ such that the $a_i$ and $b_i$ are not connected, but $a_i$ and $b_j$ for $i\neq j$ are connected, then our walk-counting problem becomes analogous to the $K_n$ problem. Any valid will alternate between $A$ and $B$, but have \textit{no index repeated twice in a row}. That is, $a_1b_2$ is a valid step, while $a_1b_1$ is not. We can use this to establish an bijection between $l$-walks starting in $A$ and $l$-walks on $K_n$, meaning that the \textit{total} number of $l$-walks on $K_{n,n}-nK_2$ is \[2n\left(\frac{1}{n}\left((n-1)^l+(n-1)(-1)^l\right)\right)=2(n-1)^l+2(n-1)(-1)^l.\] For odd $l$, the number of walks is $0$, and so $\sum\lambda_i^l$ agrees for all positive $l$ with \[(n-1)^l+(1-n)^l+(n-1)((-1)^l+(1)^l),\] meaning that our eigenvalues are \[\pm 1(n-1\text{ times}),\pm(n-1)\text{(once each)}.\]
    \end{enumerate}
\end{proof}
\begin{problem}[\textcolor{red}{On the largest eigenvalue of $A(G)$}; \textbf{Extra credit}]\phantom{0}

\begin{enumerate}[(i)]
    \item Let $G$ be a graph with max degree $\Delta(G)$. Let $\lambda_1$ be the largest eigenvalue of $A(G)$. Show that $\lambda_1\leq\Delta(G)$.
    \item Let $G$ be a simple graph with $m$ edges. Show that $\lambda_1\leq \sqrt{2m}$.
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}[(i)]
        \item 
    \end{enumerate}
\end{proof}
\begin{problem}
\phantom{0}
\begin{enumerate}[(i)]
    \item Start with $n$ coins heads up. Choose a coin at random and turn it over. Do this a total of $m$ times. What is the probability that all coins will have heads up?
    \item Same as (i), except now compute the probability that all coins have tails up.
    \item Same as (i), but now we turn over two coins at a time.
\end{enumerate}
\end{problem}
\begin{proof}[Solution]
\begin{enumerate}[{i}]
    \item Flipping a coin can be modeled by walking to an adjacent vertex on a hypercube, $Q_n$. Recall from lecture that the eigenvalues of $A(Q_n)$ are of the form $n-2i$ as $i$ ranges from $0$ to $n$, where $\lambda_i=n-2i$ has multiplicity $\binom{n}{i}$. Thus, after $m$ flips the eigenvalues of $A{(Q_n)}^m$ are of the form ${(n-2i)}^m$. The number of closed $m$-walks on $Q_n$ is then
    \begin{align*}
        \sum_{i = 0}^{n} \binom{n}{i} (n-2i)^m
    \end{align*}
    In total, there are $n^m$ possible $m$-walks, so the probability that a given $m$-walk on this hypercube is closed, which is also the probability we end our $m$-flips with all heads, is $\frac{\sum_{i = 0}^{n} \binom{n}{i} (n-2i)^m}{n^m}$.

    \item Flipping all coins to tails is the same as walking to the opposite vertex on the hypercube. FINISIH PROOF
    \item START PROOF
\end{enumerate}
 \begin{enumerate}[(i)]
     \item By writing the chain of coins as a string of ones and zeros (where a zero corresponds to a tail), each flip changes exactly one digit. We can thus view the process of $m$ flips as an $m$-walk on an $n$-dimensional hypercube, making our probability \[\frac{\#\text{ closed }m-\text{walks from a given vertex to itself}}{\#m-\text{walks starting at a given vertex}},\]which is also \[\frac{\#\text{closed }m-\text{walks}}{\#m-\text{walks}}\text{ on }\ZZ_2^n.\] We find the number of closed $m$-walks on $\ZZ_2^n$ by finding the graph's eigenvalues. We view $\ZZ_2^n$ as the graph direct sum of $\ZZ_2^{n-1}$ and $\ZZ_2$, that is, a bipartite graph with partites of size $2^{n-1}$. From Q2(ii), for even $m$, we have \[2(2^{n-1}2^{n-1})^m=(2^{2n-2})^m+(-2^{2n-2})^m\] closed $m$-walks. For odd $m$, we have $0=(2^{2n-2})^m+(-2^{2n-2})^m$ closed $m$-walks. Therefore, $(2^{2n-2})^m+(-2^{2n-2})^m$ and $\sum\lambda_i^m$ agree for all positive $m$, so the eigenvalues are precisely $\pm2^{2n-2}$ and some number of $0$s. Thus, the number of closed $m$-walks is $(2^{2n-2})^m+(-2^{2n-2})^m$. There are naturally $n^m$ total possible $m$-walks,  by the combinatorial argument that we choose between $n$ coins to flip $m$ times (or that each edge has). Therefore, the probability that a given $m$-walk on this hypercube is closed, which is also the probability we end our $m$-flips with all heads, is \[\boxed{\frac{(4^{n-1})^m+(-4^{n-1})^m}{n^m}}.\]
     \item We want to find the number of $m$-walks from vertex $\underbrace{000\cdots000}_{n\text{ zeroes}}$ to vertex $\underbrace{111\cdots111}_{n\text{ ones}}$, which is $(A(G)^m)_{0,2^n}$. Note that since the eigenvalues we previously found are $\pm2^{2n-2}$ and $2^{n}-2$ zeroes, we can diagonalize \[A(G)=S\mathop{\mathrm{diag}}(2^{2n-2},-2^{2n-2},\underbrace{0,0,0,\cdots,0}_{2^n-2})S^{-1},\] with some permutation of these diagonal elements. Then, 
     \begin{align*}
         (A(G))^{k+2}&=S\mathop{\mathrm{diag}}(2^{(2n-2)(k+2)},(-2^{2n-2})^{k+2},0,\cdots)S^{-1}\\
         &=S\mathop{\mathrm{diag}}((2^{2n-2})^22^{(2n-2)(k)},(2^{2n-2})^2(-2^{2n-2})^{k},0,\cdots)S^{-1}\\
         &=2^{4n-4}S\mathop{\mathrm{diag}}(2^{(2n-2)k},(-2^{2n-2})^{k},0,\cdots)S^{-1}\\
         &=2^{4n-4}(A(G))^k,
     \end{align*}
     so if we know the number of valid $m$-walks, we know the number of valid $m+2c$ walks. That is, if we know the number of ways to go from all heads to all tails in $m$ moves, we know the number of ways to do so in all $m+2c$ moves. The fewest number of moves in which we could flip from all heads to all tails is $n$, which is simply flipping each coin. There are also naturally $n!$ ways to do our flipping in $n$ moves, so if $m$ is the same parity as $n$, the number of valid $m$-walks is \[2^{(4n-4)\frac{m-n}{2}}n!=4^{(n-2)(m-n)}n!.\] Notice that, by the coin-flipping mechanism, when the $m$ and $n$ are not the same parity, we have no possibilities (we will be in the wrong partite of the graph). \[\frac{4^{(n-2)(m-n)}n!}{n^m}\] FINISH EXPLANATION
 \end{enumerate}

\end{proof}
\begin{problem}
    Let $G_n$ be the graph with vertex set $\ZZ_2^n$ with the edge set defined as: $u$ and $v$ are adjacent iff they differ in exactly two coordinates (that is, $\omega(u+v)=2$). What are the eigenvalues of $G_n$?
    
\end{problem}
\begin{proof}
    Recall from lecture that the eigenvalues of $A(Q_n)$ are of the form $n-2i$ as $i$ ranges from $0$ to $n$, where $\lambda_i=n-2i$ has multiplicity $\binom{n}{i}$. Consider $A(Q_n)^2$. We aim to show that \[A(Q_n)^2=nI_n+2A(G_n)\] via a walk counting argument. $A(Q_n)^2_{ij}$ counts the number of $2$-walks from $i$ to $j$ (vertices on the hypercube). When $i=j$, this is precisely $\deg i=n$. When $i\neq j$, for there to be a $2$-walk from $i$ to $j$, we must have $\omega(i+j)=2$. Each step flips one coordinate of $i$, and since there must be exactly two coordinates to flip, we have $2!=2$ such walks. Thus, $A(Q_n)^2_{ij}=2$ when $\omega(i+j)=2$. $2A(G_n)$ is the matrix with $2$s when $\omega(i+j)=2$ and zeroes elsewhere, and $nI_n$ is the matrix with $n$s along the diagonal. Therefore, \[A(Q_n)^2=nI_n+2A(G_n),\] so for any given eigenvalue $\lambda_i$ of $Q_n$, since $A(Q_n)$ is diagonalizable, $\lambda_i^2$ is an eigenvalue of $A(Q_n)^2$. Thus,
    \begin{align*}
        \det(A(Q_n)^2-\lambda_i^2I_n)&=0\\
        \det(nI_n+2A(G_n)-\lambda_i^2I_n)&=0\\
        \det(2A(G_n)-(\lambda_i^2-n)I_n)&=0\\
        \det\left(A(G_n)-\frac{\lambda_i^2-n}{2}I_n\right)&=0,
    \end{align*} 
    so $\frac{\lambda_i^2-n}{2}=\frac{(n-2i)^2-n}{2}$ is an eigenvalue of $G_n$, as $i$ ranges from $0$ to $n$.
\end{proof}
\end{document}
